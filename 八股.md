# java基础

## 为什么Java解释和编译都有？

回答：

在一般情况下，Java运行的流程是，首先将Java源代码编译成字节码文件，然后JVM再将字节码文件通过解释器逐行解释为机器码，然后运行。这就是Java的编译性和解释性。

后来，JVM中出现一个叫JIT（Just-In-Time）的即时编译技术，能够在在运行时将热点字节码通过编译器编译为机器码，而不再需要每次都解释，从而提高运行效率。这也是算是一种编译性。

所以，Java既是编译型也是解释性语言，默认采用的是解释器和编译器混合的模式。

# Redis

## Redis主从和集群可以保证数据一致性吗？

回答：

redis主从和集群在CAP理论都属于AP模型，即在面临网络分区时选择保证可用性和分区容忍性，而牺牲了强一致性。这意味着在网络分区的情况下，Redis主从复制和集群可以继续提供服务并保持可用，但可能会出现部分节点之间的数据不一致。

扩展:

1.Redis集群

Redis集群（Redis Cluster）是一种**分布式部署模式**，用于在多个节点之间分片存储数据，并提供高可用性。它通过**数据分片（sharding）**和**主从复制（master-slave replication）**来实现负载均衡和容错能力。

Redis集群的核心特点包括：

**数据被分片**到多个主节点（Master），每个主节点负责存储部分数据。

**多主多从架构（Multi-Master, Multi-Slave）：** 每个主节点（master）都管理一部分哈希槽，并可以有多个从节点（slave）进行数据同步，提供数据冗余和高可用性。

**故障转移（Failover）：** 当某个主节点宕机时，其从节点可以自动提升为主节点，以保证服务的连续性。

**不保证强一致性（Eventual Consistency）：** 由于主从复制是异步的，在网络分区或者节点故障的情况下，部分数据可能会丢失或出现数据不一致的情况。

2.CAP理论

CAP理论是分布式系统三大特性，描述了分布式系统在网络分区发生时，必须在一致性和可用性之间做出权衡。

> 网络分区（Network Partition）指的是 **在分布式系统中，某些服务器之间的网络连接发生故障，导致它们无法相互通信**，但系统的不同部分仍然可以对外提供服务。**“分区”** 就是指 **整个网络被分成了相互隔离的部分**，这些部分之间的数据无法互通。
>
> 例如：
>
> 假设有一个 **主从架构的 Redis**，`Master` 负责写入，`Slave` 负责备份数据。
>
> 如果 `Master` 和 `Slave` 之间的网络断开了（发生网络分区），会出现两种情况：
>
> 1. **Master 继续接受写入**，但 `Slave` 无法接收到新数据，导致数据不一致。（即AP）
> 2. **Redis 可能触发故障转移**，把 `Slave` 提升为新的 `Master`，但此时旧的 `Master` 仍然存在，两个 `Master` 可能会产生数据冲突。

**一致性（Consistency）：** 所有节点在同一时间点看到的数据是相同的。即所有读取请求都能返回最新写入的数据。

**可用性（Availability）：** 系统始终能够对请求做出响应，即使某些节点发生故障，系统仍能正常提供服务。

**分区容忍性（Partition Tolerance）：** 系统在遇到网络分区（即部分节点无法通信）时仍能继续运行。

CAP理论指出，在网络分区不可避免的情况下（P属性始终需要满足），分布式系统只能在一致性（C）和可用性（A）之间做选择。例如：

- **CP（强一致性 + 分区容忍）：** 牺牲可用性，在网络分区时可能拒绝请求以保证数据一致性。例如，Zookeeper、Etcd。
- **AP（高可用性 + 分区容忍）：** 牺牲强一致性，在网络分区时允许不同节点数据短暂不一致，以保证服务可用性。例如，Redis、Cassandra、DynamoDB。